<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    <link rel="stylesheet" href="style.css">
</head>
<body style="background:#000; color:#fff; text-align:center;">

    <div id="loading" style="margin-top:100px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>

    <div id="admin-content" style="display:none; max-width:600px; margin:50px auto; background:#111; padding:20px; border-radius:10px;">
        <h2>ğŸ› ï¸ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h2>
        <input type="text" id="p-img" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
        <input type="text" id="p-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
        <textarea id="p-desc" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬"></textarea>
        <div style="display:flex; gap:10px;">
            <input type="text" id="p-price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
            <input type="text" id="p-method" placeholder="Ø§Ù„Ø¹Ù…Ù„Ø©/Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© (Ù…Ø«Ù„ Ø³ÙˆØ§ØŒ USDT)">
        </div>
        <button onclick="addProduct()" style="width:100%; padding:10px; background:#5865F2; color:#fff; border:none; margin-top:10px; cursor:pointer;">Ù†Ø´Ø±</button>
    </div>

    <script src="script.js"></script>
    <script>
        const CLIENT_ID = "1474893422845231177";
        const REDIRECT_URI = encodeURIComponent("https://vercal-studio.vercel.app/adminpanel.html");

        async function check() {
            const code = new URLSearchParams(window.location.search).get('code');
            if (!code) {
                window.location.href = `https://discord.com/oauth2/authorize?client_id=${CLIENT_ID}&response_type=code&redirect_uri=${REDIRECT_URI}&scope=identify+guilds.members.read`;
                return;
            }
            try {
                const res = await fetch(`/api/auth?code=${code}`);
                const data = await res.json();
                if (data.hasRole) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('admin-content').style.display = 'block';
                    sessionStorage.setItem('isAdmin', 'true');
                } else {
                    alert("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©"); // Ø±Ø¬Ø¹Øª Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ø¨ØªØ§Ø¹ Ø²Ù…Ø§Ù†
                    window.location.href = 'index.html';
                }
            } catch (e) { location.reload(); }
        }
        window.onload = check;
    </script>
</body>
</html>
